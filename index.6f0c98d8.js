var e={};Object.defineProperty(e,"Game",{get:function(){return t},set:void 0,enumerable:!0,configurable:!0});class t{constructor(e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=e,this.size=4,this.status="idle",this.gameField=this.initialState,this.score=0}start(){this.status="playing",this.#e(),this.#e()}restart(){this.status="idle",this.score=0,this.gameField=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}getStatus(){return this.status}getScore(){return this.score}getState(){return this.gameField}moveLeft(){if("playing"===this.status){let e=this.gameField.map(e=>this.#t(e));this.#s(e)}}moveRight(){if("playing"===this.status){let e=this.gameField.map(e=>{let t=e.slice().reverse();return this.#t(t).reverse()});this.#s(e)}}moveUp(){if("playing"===this.status){let e=this.#i(this.gameField).map(e=>this.#t(e));this.#s(this.#i(e))}}moveDown(){if("playing"===this.status){let e=this.#i(this.gameField).map(e=>{let t=e.slice().reverse();return this.#t(t).reverse()});this.#s(this.#i(e))}}#e(){let[e,t]=this.#r();this.gameField[e][t]=.8>Math.random()?2:4}#r(){let e=[];return this.gameField.forEach((t,s)=>{t.forEach((t,i)=>{0===t&&e.push([s,i])})}),e[Math.floor(Math.random()*e.length)]}#t(e){let t=e.filter(e=>0!==e),s=[],i=0;for(;i<t.length;)t[i]===t[i+1]?(s.push(2*t[i]),this.score+=2*t[i],i+=2):(s.push(t[i]),i+=1);return s.push(...Array(4-s.length).fill(0)),s}#i(e){return e[0].map((t,s)=>e.map(e=>e[s]))}#l(e){return JSON.stringify(this.gameField)!==JSON.stringify(e)}#a(){this.status=this.gameField.some(e=>e.includes(2048))?"win":this.status}#n(){for(let e of this.gameField){if(e.some(e=>0===e))return!1;for(let t=0;t<e.length;t++)if(e[t]===e[t+1])return!1}for(let e=0;e<4;e++){let t=[this.gameField[0][e],this.gameField[1][e],this.gameField[2][e],this.gameField[3][e]];for(let e=0;e<t.length;e++)if(t[e]===t[e+1])return!1}return!0}#s(e){this.#l(e)&&(this.gameField=e,this.#e(),this.#a(),this.#n()&&(this.status="lose"))}}const s=new(e=t),i=document.querySelector("button"),r=document.querySelector(".message-start"),l=document.querySelector(".message-win"),a=document.querySelector(".message-lose"),n=document.querySelector(".game-score"),o=document.querySelectorAll(".field-row");function h(){let e=s.getState();for(let t=0;t<4;t++)for(let s=0;s<4;s++){let i=o[t].children[s],r=e[t][s];0===r?(i.textContent="",i.className="field-cell"):(i.textContent=r,i.className=`field-cell field-cell--${r}`,i.style.top="0px",i.style.left="0px"),setTimeout(()=>{i.style.top="100px",i.style.left="100px"},400)}n.textContent=s.getScore()}i.addEventListener("click",e=>{e.preventDefault(),"idle"===s.getStatus()?(s.start(),h(),i.className="button restart",i.textContent="Restart",r.classList.add("hidden")):(s.restart(),i.className="button start",i.textContent="Start",r.classList.remove("hidden"),a.classList.add("hidden"),l.classList.add("hidden"),h())}),document.addEventListener("keydown",function(e){switch(e.preventDefault(),"win"===s.getStatus()&&l.classList.remove("hidden"),"lose"===s.getStatus()&&a.classList.remove("hidden"),e.key){case"ArrowDown":s.moveDown(),h();break;case"ArrowLeft":s.moveLeft(),h();break;case"ArrowRight":s.moveRight(),h();break;case"ArrowUp":s.moveUp(),h()}});
//# sourceMappingURL=index.6f0c98d8.js.map
